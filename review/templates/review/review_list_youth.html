{% load static %}
{% load matching_filters %}

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>후기 작성</title>
</head>
<body>
    <div class="tab-container">
        <a href="{% url 'review:review_list_youth' %}" class="tab active">후기 작성 전</a>
        <a href="{% url 'review:review_completed_list_youth' %}" class="tab">후기 작성 완료</a>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // 현재 URL 경로에 따라 탭 활성화 상태 변경
        const tabs = document.querySelectorAll('.tab');
        const currentPath = window.location.pathname;

        tabs.forEach(tab => {
            if (tab.getAttribute('href') === currentPath) {
                tab.classList.add('active');
            } else {
                tab.classList.remove('active');
            }
        });
    });
    </script>

    {% if reviewable_requests %}
        {% for request in reviewable_requests %}
            <div class="card">
                <p>입주 요청일 {{ request.requested_at|date:"Y.m.d" }}</p>
                <hr>
                <div class="request-info">
                    <img src="{% static 'images/room_default.jpg' %}" alt="방 사진" class="room-image">
                    <div class="senior-info">
                        <h3>{{ request.room.owner.username }} ({{ request.room.owner.age }}세, {% if request.room.owner.gender == 'F' %}여성{% else %}남성{% endif %})</h3>
                        <h3>성향 매칭 점수 {{ request.youth|calculate_matching_score_filter:request.room.owner }}점</h3>
                        <p>{{ request.room.address_city }} {{ request.room.address_district }}</p>
                        <p>월세 {{ request.room.rent_fee|floatformat:"0" }}/{{ request.room.deposit|floatformat:"0" }}</p>
                        <p>{{ request.room.owner.get_living_type_display }}</p>
                    </div>
                </div>
                <div class="button-group">
                    <a href="{% url 'review:review_write' request.id %}">
                        <button class="write-review-button">후기 작성하기</button>
                    </a>
                </div>
            </div>
        {% endfor %}
    {% else %}
        <p>후기를 작성할 수 있는 시니어-방이 없습니다.</p>
    {% endif %}
</body>
</html>