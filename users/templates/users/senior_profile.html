{% load static %}
{% load custom_filters %}

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ owner.username }}님의 프로필</title>
    <link rel="stylesheet" href="{% static 'users/css/senior_profile.css' %}">
</head>
<body>
    <div id="root">
        <div id="app-wrapper">

            <div class="header">
                <!-- 백 버튼 누르면 '방 상세 페이지로 이동' 현재는 임시 주소로, 최종 수정 필요 -->
                <a href="http://localhost:8000/room/detail/1/">  
                    <img src="{% static 'users/images/Vector.png' %}" alt="" class="icon">
                </a>
                <h1>성향 매칭 분석 결과</h1>
            </div>

    <div class="profile-container">

        <div class="profile-header">
            <img src="{% if owner.profile_image %}{{ owner.profile_image.url }}{% else %}{% static 'users/images/default_profile.png' %}{% endif %}" alt="프로필 사진" class="profile-image">
            <div class="user-info">
                <h3>{{ owner.username }}</h3>
                <p class="age_gender">{{ owner.age }}세 {{ owner.get_gender_display }}</p>
                <p class="living_type">
                    {% if owner.living_type_other %}
                        {{ owner.living_type_other }}
                    {% else %}
                        {{ owner.get_living_type_display }}
                    {% endif %}
                </p>
                <div class="verification">
                    {% if owner_is_id_card_uploaded %}
                        <span class="verified">✔ 신분증 인증 완료</span>
                    {% else %}
                        <span class="unverified">⚠️ 신분증 미인증</span>
                    {% endif %}

                    {% if is_land_register_verified %}
                        <span class="verified">✔ 등기부등본 인증 완료</span>
                    {% else %}
                        <span class="unverified">⚠️ 등기부등본 미인증</span>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="line1"></div> 

        <div class="matching-result">
            <h4>성향 매칭 분석 결과</h4>
            <p class="matching-text">{{ matching_text }}</p>
            <div class="score-bar" aria-label="매칭 점수{{ matching_score }}점">
                <div class="score-fill"></div>
                <div class="score-text">{{ matching_score }}점</div>
            </div>
            <p class="explanation">{{ explanation }}</p>
            <div class="hashtags">
                {% for tag in hashtags %}
                    <span>#{{ tag }}</span>
                {% endfor %}
            </div>
        </div>

        <div class="line2"></div>

        <div class="traits-section">
            <h4>각자의 성향</h4>

            <div class="trait-item">
                <div class="trait-label">활동 시간대</div>
                <div class="trait-values">
                    <div class="trait-user">
                        <p class="trait-user-name">{{ owner.username }}(시니어)</p>
                        <p class="trait-value {% if owner.preferred_time == youth_user.preferred_time %}trait-value-matched{% endif %}">
                            {{ owner.get_preferred_time_display }}
                        </p>
                    </div>
                    <div class="trait-user">
                        <p class="trait-user-name">{{ youth_user.username }}(나)</p>
                        <p class="trait-value {% if owner.preferred_time == youth_user.preferred_time %}trait-value-matched{% endif %}">
                            {{ youth_user.get_preferred_time_display }}
                        </p>
                    </div>
                </div>
            </div>

            <div class="trait-item">
                <div class="trait-label">대화 스타일</div>
                <div class="trait-values">
                    <div class="trait-user">
                        <p class="trait-user-name">{{ owner.username }}(시니어)</p>
                        <p class="trait-value {% if owner.conversation_style == youth_user.conversation_style %}trait-value-matched{% endif %}">
                            {{ owner.get_conversation_style_display }}
                        </p>
                    </div>
                    <div class="trait-user">
                        <p class="trait-user-name">{{ youth_user.username }}(나)</p>
                        <p class="trait-value {% if owner.conversation_style == youth_user.conversation_style %}trait-value-matched{% endif %}">
                            {{ youth_user.get_conversation_style_display }}
                        </p>
                    </div>
                </div>
            </div>

            <div class="trait-item">
                <div class="trait-label">식사</div>
                <div class="trait-values">
                    <div class="trait-user">
                        <p class="trait-user-name">{{ owner.username }}(시니어)</p>
                        <p class="trait-value {% if owner.meal_preference == youth_user.meal_preference %}trait-value-matched{% endif %}">
                            {{ owner.get_meal_preference_display }}
                        </p>
                    </div>
                    <div class="trait-user">
                        <p class="trait-user-name">{{ youth_user.username }}(나)</p>
                        <p class="trait-value {% if owner.meal_preference == youth_user.meal_preference %}trait-value-matched{% endif %}">
                            {{ youth_user.get_meal_preference_display }}
                        </p>
                    </div>
                </div>
            </div>

            <div class="trait-item">
                <div class="trait-label">주말</div>
                <div class="trait-values">
                    <div class="trait-user">
                        <p class="trait-user-name">{{ owner.username }}(시니어)</p>
                        <p class="trait-value {% if owner.weekend_preference == youth_user.weekend_preference %}trait-value-matched{% endif %}">
                            {{ owner.get_weekend_preference_display }}
                        </p>
                    </div>
                    <div class="trait-user">
                        <p class="trait-user-name">{{ youth_user.username }}(나)</p>
                        <p class="trait-value {% if owner.weekend_preference == youth_user.weekend_preference %}trait-value-matched{% endif %}">
                            {{ youth_user.get_weekend_preference_display }}
                        </p>
                    </div>
                </div>
            </div>

            <div class="trait-item">
                <div class="trait-label">흡연</div>
                <div class="trait-values">
                    <div class="trait-user">
                        <p class="trait-user-name">{{ owner.username }}(시니어)</p>
                        <p class="trait-value {% if owner.smoking_preference == youth_user.smoking_preference %}trait-value-matched{% endif %}">
                            {{ owner.get_smoking_preference_display }}
                        </p>
                    </div>
                    <div class="trait-user">
                        <p class="trait-user-name">{{ youth_user.username }}(나)</p>
                        <p class="trait-value {% if owner.smoking_preference == youth_user.smoking_preference %}trait-value-matched{% endif %}">
                            {{ youth_user.get_smoking_preference_display }}
                        </p>
                    </div>
                </div>
            </div>

            <div class="trait-item">
                <div class="trait-label">소음 발생</div>
                <div class="trait-values">
                    <div class="trait-user">
                        <p class="trait-user-name">{{ owner.username }}(시니어)</p>
                        <p class="trait-value {% if owner.noise_level == youth_user.noise_level %}trait-value-matched{% endif %}">
                            {{ owner.get_noise_level_display }}
                        </p>
                    </div>
                    <div class="trait-user">
                        <p class="trait-user-name">{{ youth_user.username }}(나)</p>
                        <p class="trait-value {% if owner.noise_level == youth_user.noise_level %}trait-value-matched{% endif %}">
                            {{ youth_user.get_noise_level_display }}
                        </p>
                    </div>
                </div>
            </div>

            <div class="trait-item">
                <div class="trait-label">공간 공유</div>
                <div class="trait-values">
                    <div class="trait-user">
                        <p class="trait-user-name">{{ owner.username }}(시니어)</p>
                        <p class="trait-value {% if owner.space_sharing_preference == youth_user.space_sharing_preference %}trait-value-matched{% endif %}">
                            {{ owner.get_space_sharing_preference_display }}
                        </p>
                    </div>
                    <div class="trait-user">
                        <p class="trait-user-name">{{ youth_user.username }}(나)</p>
                        <p class="trait-value {% if owner.space_sharing_preference == youth_user.space_sharing_preference %}trait-value-matched{% endif %}">
                            {{ youth_user.get_space_sharing_preference_display }}
                        </p>
                    </div>
                </div>
            </div>

            <div class="trait-item">
                <div class="trait-label">반려동물</div>
                <div class="trait-values">
                    <div class="trait-user">
                        <p class="trait-user-name">{{ owner.username }}(시니어)</p>
                        <p class="trait-value {% if owner.pet_preference == youth_user.pet_preference %}trait-value-matched{% endif %}">
                            {{ owner.get_pet_preference_display }}
                        </p>
                    </div>
                    <div class="trait-user">
                        <p class="trait-user-name">{{ youth_user.username }}(나)</p>
                        <p class="trait-value {% if owner.pet_preference == youth_user.pet_preference %}trait-value-matched{% endif %}">
                            {{ youth_user.get_pet_preference_display }}
                        </p>
                    </div>
                </div>
            </div>

            <div class="trait-item">
                <div class="trait-label">중요한 점</div>
                <div class="trait-values">
                    <div class="trait-user">
                        <p class="trait-user-name">{{ owner.username }}(시니어)</p>
                        <p class="trait-value">
                            {{ owner.important_points|get_important_points_display }}
                        </p>
                    </div>
                    <div class="trait-user">
                        <p class="trait-user-name">{{ youth_user.username }}(나)</p>
                        <p class="trait-value">
                            {{ youth_user.important_points|get_important_points_display }}
                        </p>
                    </div>
                </div>
            </div>

        </div>
    </div>
    
    <!-- nav-bar(입주 희망 요청 버튼) -->
     <!-- <div class="footer">
        이따 main merge하고 방 상세 페이지에 있는 버튼 갖다 쓰기.
     </div> -->


        </div>
    </div>
    <script>addEventListener('DOMContentLoaded',()=>{const f=document.querySelector('.score-fill'); if(f && !f.style.width) f.style.width='{{ matching_score|default:0 }}%';});</script>
    <script src="{% static 'users/js/senior_profile.js' %}?v=8"></script>
</body>
</html>